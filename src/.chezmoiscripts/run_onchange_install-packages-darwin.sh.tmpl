{{ if eq .chezmoi.os "darwin" -}}
#!/bin/bash

# Install macOS Packages

# Install/Update mise
curl https://mise.run | sh

# After mise is installed, source it to make it available in the script
eval "$(~/.local/bin/mise activate bash)"  # or zsh if using zsh

# Install common packages using mise
echo "Installing common packages using mise..."
mise use -g bat@latest
mise use -g fastfetch@latest
mise use -g fd@latest
mise use -g fzf@latest
mise use -g eza@latest
mise use -g gh@latest
mise use -g lazydocker@latest
mise use -g lazygit@latest
mise use -g zoxide@latest

brew bundle --file=/dev/stdin <<EOF
# ============================================================================
# Common Taps (Personal + Work)
# ============================================================================
tap "FelixKratz/formulae"
tap "jandedobbeleer/oh-my-posh"


# ============================================================================
# Common Brews (Personal + Work)
# ============================================================================
brew "atuin"
brew "bash"
brew "bash-completion"
brew "borders"
brew "cabextract"
brew "chezmoi"
brew "ffmpeg"
brew "freetype"
brew "git"
brew "htop"
brew "imagemagick"
brew "jandedobbeleer/oh-my-posh/oh-my-posh"
brew "jq"
brew "libpng"
brew "nano"
brew "openssh"
brew "tmux"
brew "trash"
brew "zsh"

{{- if eq .workspace "personal" }}
# ============================================================================
# Personal-Only Brews
# ============================================================================
brew "exercism"
{{- end }}

# ============================================================================
# Common Casks (Personal + Work)
# ============================================================================
cask "1password"
cask "1password-cli"
cask "alfred"
cask "bartender"
cask "bruno"
cask "claude"
cask "claude-code"
cask "cursor"
cask "cyberduck"
cask "dropbox"
cask "figma"
cask "firefox"
cask "font-hack-nerd-font"
cask "font-jetbrains-mono-nerd-font"
cask "fontplop"
cask "github"
cask "ghostty"
cask "google-chrome"
cask "imagealpha"
cask "imageoptim"
cask "inkdrop"
cask "iterm2"
cask "karabiner-elements"
cask "libreoffice"
cask "logi-options+"
cask "mac-mouse-fix"
cask "numi"
cask "readdle-spark"
cask "rectangle-pro"
cask "slack"
cask "spotify"
cask "stats"
cask "tableplus"
cask "the-unarchiver"
cask "visual-studio-code"
cask "wezterm"
cask "zen"

{{- if eq .workspace "personal" }}
# ============================================================================
# Personal-Only Casks
# ============================================================================
cask "alacritty"
cask "appcleaner"
cask "balenaetcher"
cask "blender"
cask "openvpn-connect"
cask "private-internet-access"
cask "via"
cask "vlc"
{{- end }}

{{- if eq .workspace "work" }}
# ============================================================================
# Work-Only Casks
# ============================================================================
cask "zoom"
{{- end }}
EOF

{{ end -}}
